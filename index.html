<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Realtouch Academy - AI-Powered Lesson Generator</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        .animate-spin { animation: spin 1s linear infinite; }
        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        @media print { .no-print { display: none !important; } .print-slide { page-break-after: always; } }
        .ai-indicator { 
            background: linear-gradient(45deg, #4f46e5, #7c3aed, #ec4899);
            background-size: 300% 300%;
            animation: gradient 3s ease infinite;
        }
        @keyframes gradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useRef } = React;
        
        // Icons
        const ChevronLeft = () => <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 19l-7-7 7-7" /></svg>;
        const ChevronRight = () => <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 5l7 7-7 7" /></svg>;
        const Play = ({ className }) => <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M14.828 14.828a4 4 0 01-5.656 0M9 10h1m4 0h1m-6 4h.01M19 10a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>;
        const Users = ({ className }) => <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.25 2.25 0 11-4.5 0 2.25 2.25 0 014.5 0z" /></svg>;
        const Clock = ({ className }) => <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>;
        const Target = ({ className }) => <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>;
        const BookOpen = ({ className }) => <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" /></svg>;
        const Download = ({ className }) => <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" /></svg>;
        const Sparkles = ({ className }) => <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 3l1.5 1.5L5 6l-1.5-1.5L5 3zM19 3l1.5 1.5L19 6l-1.5-1.5L19 3zM5 21l1.5-1.5L5 18l-1.5 1.5L5 21zM19 21l1.5-1.5L19 18l-1.5 1.5L19 21zM9 12l1.5-1.5L9 9l-1.5 1.5L9 12zM15 12l1.5-1.5L15 9l-1.5 1.5L15 12z" /></svg>;
        const Brain = ({ className }) => <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" /></svg>;

        const DynamicLessonGenerator = () => {
            const [formData, setFormData] = useState({
                subject: '',
                keyStage: '',
                topic: '',
                duration: '60',
                classSize: '12',
                specificRequirements: '',
                apiKey: ''
            });
            
            const [generatedLesson, setGeneratedLesson] = useState(null);
            const [currentSlide, setCurrentSlide] = useState(0);
            const [isGenerating, setIsGenerating] = useState(false);
            const [error, setError] = useState(null);
            const [generationProgress, setGenerationProgress] = useState('');

            // UK Curriculum Framework
            const curriculumFramework = {
                KS2: {
                    Maths: {
                        topics: [
                            'Number and Place Value', 'Addition and Subtraction', 'Multiplication and Division', 
                            'Fractions (including decimals and percentages)', 'Measurement', 'Geometry - Properties of shapes', 
                            'Geometry - Position and direction', 'Statistics'
                        ],
                        standards: 'KS2 National Curriculum for Mathematics (Ages 7-11)',
                        assessmentCriteria: 'Working towards expected standard, At expected standard, Greater depth'
                    },
                    English: {
                        topics: [
                            'Reading Comprehension', 'Creative Writing', 'Grammar and Punctuation', 'Spelling', 
                            'Speaking and Listening', 'Poetry', 'Handwriting', 'Vocabulary Building'
                        ],
                        standards: 'KS2 National Curriculum for English (Ages 7-11)',
                        assessmentCriteria: 'Working towards expected standard, At expected standard, Greater depth'
                    },
                    Science: {
                        topics: [
                            'Animals including humans', 'Living things and their habitats', 'Plants', 'Everyday materials',
                            'Seasonal changes', 'Forces and magnets', 'Light', 'Rocks', 'States of matter', 'Sound', 'Electricity'
                        ],
                        standards: 'KS2 National Curriculum for Science (Ages 7-11)',
                        assessmentCriteria: 'Working scientifically skills and subject knowledge'
                    }
                },
                KS3: {
                    Maths: {
                        topics: [
                            'Number', 'Algebra', 'Ratio and Proportion', 'Geometry and Measures', 
                            'Probability', 'Statistics', 'Working with coordinates', 'Sequences'
                        ],
                        standards: 'KS3 National Curriculum for Mathematics (Ages 11-14)',
                        assessmentCriteria: 'Below expected standard, At expected standard, Above expected standard'
                    },
                    English: {
                        topics: [
                            'Reading', 'Writing', 'Grammar', 'Literature', 'Language Analysis', 
                            'Creative Expression', 'Media Studies', 'Drama and Performance'
                        ],
                        standards: 'KS3 National Curriculum for English (Ages 11-14)',
                        assessmentCriteria: 'Below expected standard, At expected standard, Above expected standard'
                    },
                    Science: {
                        topics: [
                            'Biology: Cells and organisation', 'Biology: Reproduction', 'Biology: Health and lifestyle',
                            'Chemistry: Particles and their behaviour', 'Chemistry: Elements, atoms and compounds', 'Chemistry: Reactions',
                            'Physics: Energy', 'Physics: Motion and forces', 'Physics: Waves', 'Physics: Electricity and electromagnetism'
                        ],
                        standards: 'KS3 National Curriculum for Science (Ages 11-14)',
                        assessmentCriteria: 'Working scientifically and subject-specific knowledge'
                    }
                },
                KS4: {
                    Maths: {
                        topics: [
                            'Number', 'Algebra', 'Ratio, Proportion and Rates of Change', 'Geometry and Measures', 
                            'Probability', 'Statistics', 'Trigonometry', 'Quadratic Equations', 'Graphs and Functions'
                        ],
                        standards: 'GCSE Mathematics AQA/Edexcel/OCR specifications',
                        assessmentCriteria: 'Foundation (Grades 1-5) and Higher (Grades 4-9) tiers'
                    },
                    English: {
                        topics: [
                            'Language Paper 1 - Creative Reading and Writing', 'Language Paper 2 - Writers Viewpoints', 
                            'Literature Paper 1 - Modern Prose/Drama', 'Literature Paper 2 - Poetry and Unseen Poetry', 
                            'Creative Writing', 'Spoken Language Presentation'
                        ],
                        standards: 'GCSE English Language and Literature AQA/Edexcel/OCR specifications',
                        assessmentCriteria: 'GCSE grades 1-9 with grade descriptors'
                    },
                    Science: {
                        topics: [
                            'Biology: Cell biology', 'Biology: Organisation', 'Biology: Infection and response', 'Biology: Bioenergetics',
                            'Chemistry: Atomic structure', 'Chemistry: Bonding', 'Chemistry: Quantitative chemistry', 'Chemistry: Energy changes',
                            'Physics: Energy', 'Physics: Electricity', 'Physics: Particle model of matter', 'Physics: Forces'
                        ],
                        standards: 'GCSE Combined Science and separate sciences AQA/Edexcel/OCR',
                        assessmentCriteria: 'GCSE grades 1-9 across Foundation and Higher tiers'
                    }
                }
            };

            // AI Lesson Generation Function
            const generateAILesson = async () => {
                const { subject, keyStage, topic, duration, classSize, specificRequirements, apiKey } = formData;
                
                if (!apiKey) {
                    throw new Error('OpenAI API key is required for dynamic content generation');
                }

                const curriculumInfo = curriculumFramework[keyStage]?.[subject];
                if (!curriculumInfo) {
                    throw new Error(`Curriculum information not available for ${keyStage} ${subject}`);
                }

                setGenerationProgress('Building curriculum prompt...');

                // Construct detailed curriculum prompt
                const systemPrompt = `You are an expert UK curriculum teacher and lesson planner specializing in ${subject} for ${keyStage}. 

CURRICULUM CONTEXT:
- Standards: ${curriculumInfo.standards}
- Assessment: ${curriculumInfo.assessmentCriteria}
- Age-appropriate content for ${keyStage}
- Lesson duration: ${duration} minutes
- Class size: ${classSize} students

LESSON REQUIREMENTS:
Create a comprehensive, ready-to-teach lesson plan for the topic "${topic}" that includes:

1. LEARNING OBJECTIVES (3-4 specific, measurable objectives aligned to UK National Curriculum)
2. STARTER ACTIVITY (5-8 minutes, engaging hook that assesses prior knowledge)
3. MAIN CONTENT (detailed teaching content broken into 2-3 sections with):
   - Clear explanations with subject-specific examples
   - Real-world applications and contexts
   - Common misconceptions to address
   - Key vocabulary with definitions
4. INTERACTIVE ACTIVITIES (2-3 activities with specific instructions and materials)
5. ASSESSMENT QUESTIONS (4-6 questions testing different cognitive levels)
6. HOMEWORK TASKS (3 varied tasks reinforcing learning)
7. DIFFERENTIATION (support for lower ability, extension for higher ability)

SPECIFIC REQUIREMENTS: ${specificRequirements || 'Standard lesson structure'}

CONTENT QUALITY:
- Use actual subject knowledge, not generic statements
- Include specific examples, calculations, or text extracts where relevant
- Provide step-by-step explanations for complex concepts
- Suggest specific resources and materials
- Include timing for each section
- Add teacher notes for effective delivery

SAFETY AND COMPLIANCE:
- Age-appropriate content only
- Inclusive and accessible for all learners
- Follows UK educational standards and policies

Respond with a structured JSON object containing the complete lesson plan.`;

                setGenerationProgress('Connecting to OpenAI...');

                const response = await fetch('https://api.openai.com/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${apiKey}`
                    },
                    body: JSON.stringify({
                        model: 'gpt-4o',
                        messages: [
                            {
                                role: 'system',
                                content: systemPrompt
                            },
                            {
                                role: 'user',
                                content: `Create a detailed lesson plan for "${topic}" in ${subject} for ${keyStage} students. The lesson should be ${duration} minutes long for a class of ${classSize} students.`
                            }
                        ],
                        temperature: 0.7,
                        max_tokens: 4000
                    })
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(errorData.error?.message || 'Failed to generate lesson content');
                }

                setGenerationProgress('Processing AI response...');

                const data = await response.json();
                const aiContent = data.choices[0].message.content;

                // Parse AI response (handle both JSON and text responses)
                let lessonData;
                try {
                    lessonData = JSON.parse(aiContent);
                } catch (e) {
                    // If not JSON, structure the text response
                    lessonData = parseTextResponse(aiContent);
                }

                setGenerationProgress('Structuring lesson slides...');

                // Convert AI response to lesson structure
                return structureAILesson(lessonData, formData);
            };

            const parseTextResponse = (text) => {
                // Basic parsing for non-JSON responses
                const sections = text.split('\n\n');
                return {
                    learningObjectives: extractBulletPoints(text, 'objectives?|aims?'),
                    starterActivity: extractSection(text, 'starter|warm.?up|introduction'),
                    mainContent: extractSection(text, 'main|content|teaching|explanation'),
                    activities: extractBulletPoints(text, 'activit'),
                    assessment: extractBulletPoints(text, 'assessment|questions|check'),
                    homework: extractBulletPoints(text, 'homework|home.?learning'),
                    vocabulary: extractBulletPoints(text, 'vocabulary|key.?terms')
                };
            };

            const extractSection = (text, pattern) => {
                const regex = new RegExp(`(${pattern})[^\\n]*\\n([\\s\\S]*?)(?=\\n\\n|$)`, 'i');
                const match = text.match(regex);
                return match ? match[2].trim() : '';
            };

            const extractBulletPoints = (text, pattern) => {
                const regex = new RegExp(`(${pattern})[^\\n]*\\n([\\s\\S]*?)(?=\\n\\n|$)`, 'i');
                const match = text.match(regex);
                if (!match) return [];
                
                return match[2]
                    .split('\n')
                    .filter(line => line.trim())
                    .map(line => line.replace(/^[-•*]\s*/, '').trim())
                    .filter(line => line.length > 10);
            };

            const structureAILesson = (aiData, formData) => {
                const { subject, keyStage, topic, duration, classSize } = formData;

                return {
                    title: `${subject} - ${topic}`,
                    keyStage,
                    duration: `${duration} minutes`,
                    classSize: `${classSize} students`,
                    aiGenerated: true,
                    generatedAt: new Date().toISOString(),
                    learningObjectives: aiData.learningObjectives || aiData.objectives || [],
                    slides: [
                        {
                            type: 'title',
                            title: topic,
                            subtitle: `${keyStage} ${subject} | AI-Generated Lesson | Realtouch Academy`,
                            duration: 2,
                            aiGenerated: true
                        },
                        {
                            type: 'objectives',
                            title: 'Learning Objectives',
                            content: [
                                'By the end of this lesson, you will be able to:',
                                ...(aiData.learningObjectives || aiData.objectives || []).map(obj => `✓ ${obj}`)
                            ],
                            duration: 3,
                            teacherNotes: 'Review objectives, check student understanding of key terms'
                        },
                        {
                            type: 'starter',
                            title: 'Starter Activity',
                            content: aiData.starterActivity || aiData.starter || `Engaging introduction to ${topic}`,
                            activity: 'Think-Pair-Share',
                            duration: 6,
                            teacherNotes: 'Use this to assess prior knowledge and engage students'
                        },
                        {
                            type: 'main_content',
                            title: `Understanding ${topic}`,
                            content: Array.isArray(aiData.mainContent) ? aiData.mainContent : [aiData.mainContent || `Comprehensive explanation of ${topic} concepts`],
                            duration: Math.floor(duration * 0.4),
                            teacherNotes: 'Key teaching phase - use interactive questioning'
                        },
                        ...(aiData.activities || []).map((activity, index) => ({
                            type: 'interactive',
                            title: `Activity ${index + 1}`,
                            content: typeof activity === 'string' ? activity : activity.description || activity.title,
                            activity: typeof activity === 'object' ? activity.title : `${topic} Practice`,
                            duration: 12,
                            teacherNotes: 'Support struggling students, extend able learners'
                        })),
                        {
                            type: 'assessment',
                            title: 'Check Understanding',
                            content: 'Assessment questions to check learning:',
                            questions: aiData.assessment || aiData.questions || [
                                `What are the key concepts of ${topic}?`,
                                `How would you apply ${topic} knowledge?`,
                                `What questions do you have about ${topic}?`
                            ],
                            duration: 8,
                            teacherNotes: 'Use variety of assessment methods - questioning, mini-whiteboards, exit tickets'
                        },
                        {
                            type: 'homework',
                            title: 'Homework & Extension',
                            content: [
                                `Excellent work on ${topic} today!`,
                                '',
                                'Your homework tasks:',
                                ...(aiData.homework || []).map((task, index) => `${index + 1}. ${task}`),
                                '',
                                'Key vocabulary to remember:',
                                (aiData.vocabulary || []).join(', '),
                                '',
                                'Next lesson: Building on today\'s learning'
                            ],
                            duration: 4,
                            teacherNotes: 'Explain homework clearly, check understanding'
                        },
                        {
                            type: 'plenary',
                            title: 'Lesson Summary',
                            content: [
                                `Today we mastered: ${topic}`,
                                '',
                                'Key achievements:',
                                ...(aiData.learningObjectives || []).map(obj => `✓ ${obj}`),
                                '',
                                'Well done everyone! See you next lesson.'
                            ],
                            duration: 3,
                            teacherNotes: 'Summarize key learning, preview next lesson'
                        }
                    ]
                };
            };

            const handleGenerate = async () => {
                setIsGenerating(true);
                setError(null);
                setGenerationProgress('Initializing AI lesson generation...');

                try {
                    const lesson = await generateAILesson();
                    setGeneratedLesson(lesson);
                    setCurrentSlide(0);
                    setGenerationProgress('Lesson generated successfully!');
                } catch (err) {
                    setError(err.message);
                    console.error('Lesson generation error:', err);
                } finally {
                    setIsGenerating(false);
                }
            };

            const nextSlide = () => {
                if (generatedLesson && currentSlide < generatedLesson.slides.length - 1) {
                    setCurrentSlide(currentSlide + 1);
                }
            };

            const prevSlide = () => {
                if (currentSlide > 0) {
                    setCurrentSlide(currentSlide - 1);
                }
            };

            const renderSlide = (slide) => {
                const slideStyles = {
                    title: 'bg-gradient-to-br from-blue-600 to-purple-700 text-white',
                    objectives: 'bg-gradient-to-br from-green-500 to-teal-600 text-white',
                    starter: 'bg-gradient-to-br from-orange-500 to-red-500 text-white',
                    main_content: 'bg-gradient-to-br from-indigo-600 to-blue-700 text-white',
                    interactive: 'bg-gradient-to-br from-purple-600 to-pink-600 text-white',
                    assessment: 'bg-gradient-to-br from-yellow-500 to-orange-500 text-white',
                    homework: 'bg-gradient-to-br from-rose-600 to-pink-700 text-white',
                    plenary: 'bg-gradient-to-br from-emerald-600 to-green-700 text-white'
                };

                return (
                    <div className={`min-h-96 p-8 rounded-lg ${slideStyles[slide.type]} flex flex-col justify-center print-slide relative`}>
                        {slide.aiGenerated && (
                            <div className="absolute top-4 right-4 flex items-center text-white text-sm opacity-90">
                                <Sparkles className="w-4 h-4 mr-1" />
                                AI Generated
                            </div>
                        )}
                        <div className="text-center">
                            <h2 className="text-4xl font-bold mb-6">{slide.title}</h2>
                            
                            {slide.type === 'title' && (
                                <div>
                                    <p className="text-xl mb-4">{slide.subtitle}</p>
                                    <div className="flex justify-center items-center space-x-6 text-lg opacity-90">
                                        <span className="flex items-center">
                                            <Clock className="w-5 h-5 mr-2" />
                                            {generatedLesson.duration}
                                        </span>
                                        <span className="flex items-center">
                                            <Users className="w-5 h-5 mr-2" />
                                            {generatedLesson.classSize}
                                        </span>
                                        <span className="flex items-center">
                                            <Brain className="w-5 h-5 mr-2" />
                                            AI-Powered Content
                                        </span>
                                    </div>
                                </div>
                            )}
                            
                            {slide.content && (
                                <div className="text-left max-w-4xl mx-auto">
                                    {Array.isArray(slide.content) ? (
                                        slide.content.map((item, index) => (
                                            <p key={index} className="text-lg mb-3 leading-relaxed">{item}</p>
                                        ))
                                    ) : (
                                        <div className="text-lg leading-relaxed whitespace-pre-line">{slide.content}</div>
                                    )}
                                </div>
                            )}
                            
                            {slide.activity && (
                                <div className="mt-6 p-4 bg-white bg-opacity-20 rounded-lg">
                                    <p className="text-lg font-semibold flex items-center justify-center">
                                        <Play className="w-5 h-5 mr-2" />
                                        Activity: {slide.activity}
                                    </p>
                                    <p className="text-sm mt-2 opacity-90">Duration: {slide.duration} minutes</p>
                                </div>
                            )}
                            
                            {slide.questions && (
                                <div className="mt-6 text-left max-w-3xl mx-auto">
                                    {slide.questions.map((question, index) => (
                                        <div key={index} className="mb-4 p-3 bg-white bg-opacity-20 rounded-lg">
                                            <p className="text-lg">Q{index + 1}: {question}</p>
                                        </div>
                                    ))}
                                </div>
                            )}
                        </div>
                    </div>
                );
            };

            if (generatedLesson) {
                const slide = generatedLesson.slides[currentSlide];
                
                return (
                    <div className="max-w-7xl mx-auto p-6">
                        <div className="mb-6 flex justify-between items-center no-print">
                            <div>
                                <h1 className="text-2xl font-bold text-gray-800 flex items-center">
                                    <Brain className="w-6 h-6 mr-2 text-purple-600" />
                                    AI-Generated Lesson | Realtouch Academy
                                </h1>
                                <p className="text-gray-600">{generatedLesson.title} - Slide {currentSlide + 1} of {generatedLesson.slides.length}</p>
                                <p className="text-sm text-purple-600 font-medium flex items-center">
                                    <Sparkles className="w-4 h-4 mr-1" />
                                    Dynamically generated content using OpenAI GPT-4
                                </p>
                            </div>
                            <div className="flex space-x-2">
                                <button 
                                    onClick={() => setGeneratedLesson(null)}
                                    className="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors"
                                >
                                    New Lesson
                                </button>
                                <button 
                                    onClick={() => window.print()}
                                    className="px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors flex items-center"
                                >
                                    <Download className="w-4 h-4 mr-2" />
                                    Print Lesson
                                </button>
                            </div>
                        </div>
                        
                        <div className="mb-6">
                            {renderSlide(slide)}
                        </div>
                        
                        <div className="flex justify-between items-center no-print">
                            <button 
                                onClick={prevSlide}
                                disabled={currentSlide === 0}
                                className="flex items-center px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"
                            >
                                <ChevronLeft />
                                Previous
                            </button>
                            
                            <div className="flex space-x-2">
                                {generatedLesson.slides.map((_, index) => (
                                    <button
                                        key={index}
                                        onClick={() => setCurrentSlide(index)}
                                        className={`w-3 h-3 rounded-full transition-colors ${
                                            index === currentSlide ? 'bg-purple-600' : 'bg-gray-300'
                                        }`}
                                    />
                                ))}
                            </div>
                            
                            <button 
                                onClick={nextSlide}
                                disabled={currentSlide === generatedLesson.slides.length - 1}
                                className="flex items-center px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"
                            >
                                Next
                                <ChevronRight />
                            </button>
                        </div>
                        
                        <div className="mt-6 p-4 bg-gray-50 rounded-lg no-print">
                            <h3 className="font-semibold text-gray-800 mb-2">AI Generation Details:</h3>
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                                <div>
                                    <p className="text-gray-600"><strong>Generated:</strong> {new Date(generatedLesson.generatedAt).toLocaleString()}</p>
                                    <p className="text-gray-600"><strong>Model:</strong> OpenAI GPT-4</p>
                                    <p className="text-gray-600"><strong>Duration:</strong> {slide.duration} minutes</p>
                                </div>
                                <div>
                                    <p className="text-gray-600"><strong>Slide:</strong> {currentSlide + 1} of {generatedLesson.slides.length}</p>
                                    <p className="text-gray-600"><strong>Type:</strong> {slide.type.replace('_', ' ')}</p>
                                    {slide.teacherNotes && <p className="text-gray-600"><strong>Notes:</strong> {slide.teacherNotes}</p>}
                                </div>
                            </div>
                        </div>
                    </div>
                );
            }

            return (
                <div className="max-w-5xl mx-auto p-6">
                    <div className="text-center mb-8">
                        <div className="ai-indicator text-white rounded-lg p-8 mb-8">
                            <h1 className="text-4xl font-bold mb-2 flex items-center justify-center">
                                <Brain className="w-10 h-10 mr-3" />
                                Realtouch Academy
                            </h1>
                            <p className="text-xl opacity-90">AI-Powered Dynamic Lesson Generator</p>
                            <div className="w-24 h-1 bg-white bg-opacity-50 mx-auto mt-4"></div>
                            <p className="mt-4 text-lg opacity-80">Generate real curriculum content for ANY topic using advanced AI</p>
                        </div>
                    </div>

                    <div className="bg-white rounded-lg shadow-lg p-8">
                        <h2 className="text-2xl font-semibold text-gray-800 mb-6 flex items-center">
                            <Sparkles className="w-6 h-6 mr-3 text-purple-600" />
                            Create Dynamic AI Lesson
                        </h2>

                        {/* API Key Section */}
                        <div className="mb-6 p-4 bg-purple-50 rounded-lg border border-purple-200">
                            <h3 className="font-semibold text-purple-800 mb-2 flex items-center">
                                <Brain className="w-5 h-5 mr-2" />
                                AI Configuration
                            </h3>
                            <div className="mb-3">
                                <label className="block text-sm font-medium text-gray-700 mb-2">OpenAI API Key *</label>
                                <input 
                                    type="password"
                                    className="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                                    placeholder="sk-..."
                                    value={formData.apiKey}
                                    onChange={(e) => setFormData({...formData, apiKey: e.target.value})}
                                />
                                <p className="text-xs text-gray-500 mt-1">
                                    Get your API key from <a href="https://platform.openai.com/api-keys" target="_blank" className="text-purple-600 hover:underline">OpenAI Platform</a>. 
                                    Cost: ~$0.01-0.05 per lesson generated.
                                </p>
                            </div>
                        </div>

                        <div className="grid md:grid-cols-2 gap-6">
                            <div>
                                <label className="block text-sm font-medium text-gray-700 mb-2">Subject *</label>
                                <select 
                                    className="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                                    value={formData.subject}
                                    onChange={(e) => setFormData({...formData, subject: e.target.value})}
                                    required
                                >
                                    <option value="">Select Subject</option>
                                    <option value="Maths">Mathematics</option>
                                    <option value="English">English</option>
                                    <option value="Science">Science</option>
                                </select>
                            </div>

                            <div>
                                <label className="block text-sm font-medium text-gray-700 mb-2">Key Stage *</label>
                                <select 
                                    className="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                                    value={formData.keyStage}
                                    onChange={(e) => setFormData({...formData, keyStage: e.target.value})}
                                    required
                                >
                                    <option value="">Select Key Stage</option>
                                    <option value="KS2">Key Stage 2 (Ages 7-11)</option>
                                    <option value="KS3">Key Stage 3 (Ages 11-14)</option>
                                    <option value="KS4">Key Stage 4 (Ages 14-16)</option>
                                </select>
                            </div>

                            <div>
                                <label className="block text-sm font-medium text-gray-700 mb-2">Topic *</label>
                                <input 
                                    type="text"
                                    className="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                                    placeholder="e.g., Quadratic Equations, Photosynthesis, Romeo and Juliet"
                                    value={formData.topic}
                                    onChange={(e) => setFormData({...formData, topic: e.target.value})}
                                    required
                                />
                                <p className="text-xs text-gray-500 mt-1">Enter ANY curriculum topic - AI will generate appropriate content</p>
                            </div>

                            <div>
                                <label className="block text-sm font-medium text-gray-700 mb-2">Duration</label>
                                <select 
                                    className="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                                    value={formData.duration}
                                    onChange={(e) => setFormData({...formData, duration: e.target.value})}
                                >
                                    <option value="45">45 minutes</option>
                                    <option value="60">60 minutes</option>
                                    <option value="90">90 minutes</option>
                                </select>
                            </div>

                            <div>
                                <label className="block text-sm font-medium text-gray-700 mb-2">Class Size</label>
                                <input 
                                    type="number"
                                    className="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                                    placeholder="12"
                                    value={formData.classSize}
                                    onChange={(e) => setFormData({...formData, classSize: e.target.value})}
                                    min="1"
                                    max="35"
                                />
                            </div>

                            <div>
                                <label className="block text-sm font-medium text-gray-700 mb-2">Specific Requirements</label>
                                <textarea 
                                    className="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                                    rows="2"
                                    placeholder="e.g., Focus on practical applications, include group work, prepare for upcoming assessment..."
                                    value={formData.specificRequirements}
                                    onChange={(e) => setFormData({...formData, specificRequirements: e.target.value})}
                                />
                            </div>
                        </div>

                        {/* Available Topics Display */}
                        {formData.keyStage && formData.subject && curriculumFramework[formData.keyStage]?.[formData.subject] && (
                            <div className="mt-6 p-4 bg-blue-50 rounded-lg">
                                <h3 className="font-semibold text-blue-800 mb-2">
                                    Curriculum Framework: {formData.keyStage} {formData.subject}
                                </h3>
                                <p className="text-sm text-blue-700 mb-2">
                                    {curriculumFramework[formData.keyStage][formData.subject].standards}
                                </p>
                                <div className="text-xs text-blue-600">
                                    Common topics: {curriculumFramework[formData.keyStage][formData.subject].topics.slice(0, 5).join(', ')}...
                                </div>
                            </div>
                        )}

                        <div className="mt-8 text-center">
                            <button 
                                onClick={handleGenerate}
                                disabled={!formData.subject || !formData.keyStage || !formData.topic || !formData.apiKey || isGenerating}
                                className="px-8 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center mx-auto text-lg font-semibold"
                            >
                                {isGenerating ? (
                                    <>
                                        <div className="animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-3"></div>
                                        Generating with AI...
                                    </>
                                ) : (
                                    <>
                                        <Brain className="w-5 h-5 mr-3" />
                                        Generate AI Lesson Plan
                                    </>
                                )}
                            </button>
                            <p className="text-sm text-gray-500 mt-2">
                                {isGenerating ? generationProgress : 'Creates fresh curriculum content using OpenAI GPT-4'}
                            </p>
                        </div>

                        {error && (
                            <div className="mt-6 p-4 bg-red-50 border border-red-200 rounded-lg">
                                <h3 className="font-semibold text-red-800 mb-2">Generation Error</h3>
                                <p className="text-red-700 text-sm">{error}</p>
                                <div className="mt-3 text-xs text-red-600">
                                    <p>Common issues:</p>
                                    <ul className="list-disc list-inside mt-1">
                                        <li>Invalid or expired API key</li>
                                        <li>Insufficient API credits</li>
                                        <li>Network connectivity issues</li>
                                        <li>Topic too vague or inappropriate</li>
                                    </ul>
                                </div>
                            </div>
                        )}

                        {/* Features */}
                        <div className="mt-8 grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div className="text-center p-4 bg-gradient-to-br from-purple-50 to-purple-100 rounded-lg">
                                <div className="w-12 h-12 bg-purple-500 rounded-full flex items-center justify-center mx-auto mb-3">
                                    <Brain className="w-6 h-6 text-white" />
                                </div>
                                <h4 className="font-semibold text-gray-800">AI-Powered</h4>
                                <p className="text-sm text-gray-600 mt-1">OpenAI GPT-4 generates real content</p>
                            </div>
                            <div className="text-center p-4 bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg">
                                <div className="w-12 h-12 bg-blue-500 rounded-full flex items-center justify-center mx-auto mb-3">
                                    <Target className="w-6 h-6 text-white" />
                                </div>
                                <h4 className="font-semibold text-gray-800">Curriculum Aligned</h4>
                                <p className="text-sm text-gray-600 mt-1">Follows UK National Curriculum</p>
                            </div>
                            <div className="text-center p-4 bg-gradient-to-br from-green-50 to-green-100 rounded-lg">
                                <div className="w-12 h-12 bg-green-500 rounded-full flex items-center justify-center mx-auto mb-3">
                                    <Sparkles className="w-6 h-6 text-white" />
                                </div>
                                <h4 className="font-semibold text-gray-800">Unlimited Topics</h4>
                                <p className="text-sm text-gray-600 mt-1">Generate lessons for ANY subject</p>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        ReactDOM.render(<DynamicLessonGenerator />, document.getElementById('root'));
    </script>
</body>
</html>
